/* -*- c -*- */

header
{
##include "los/ltrash.h"
##include "los/lsignal.h"
##include "libltest/sigobj.h"
}

setup
{
  l_trash_push();
}

teardown
{
  l_trash_pop();
}

header
{
  struct sig_data
  {
    gint count;
  };

  static void _on_signal1 ( LObject *object,
                            gpointer data_ )
  {
    struct sig_data *data = data_;
    data->count++;
  }
}

test
{
  struct sig_data sdata;
  Sigobj *obj = L_TRASH_OBJECT(sigobj_new());
  sdata.count = 0;
  l_signal_connect(L_OBJECT(obj), "signal1", _on_signal1, &sdata, NULL);
  sigobj_signal1(obj);
  PIF_CHECK_EQ(sdata.count, 1);
}
